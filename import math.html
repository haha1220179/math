import math
import random
import matplotlib.pyplot as plt
import numpy as np

# ‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
WIDTH, HEIGHT = 100, 100

# ‡∏™‡∏∏‡πà‡∏°‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
def generate_points():
    while True:
        shooter = (random.randint(0, WIDTH), random.randint(0, HEIGHT))
        target = (random.randint(0, WIDTH), random.randint(0, HEIGHT))
        if shooter != target:
            return shooter, target

# ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏á
def plot_shot(shooter, target, formula_str):
    try:
        x_vals = np.linspace(min(shooter[0], target[0]) - 10, max(shooter[0], target[0]) + 10, 500)
        x = x_vals  # ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡πÉ‡∏ô eval
        y = eval(formula_str)

        plt.figure(figsize=(10, 6))
        plt.plot(x_vals, y, label="Your Shot", color='blue')
        plt.scatter(*shooter, color='green', label='Shooter')
        plt.scatter(*target, color='red', label='Target')
        plt.title('2D Math-Based Shooting Game')
        plt.xlabel('X')
        plt.ylabel('Y')
        plt.grid(True)
        plt.legend()
        plt.show()

        # ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        target_x, target_y = target
        index = (np.abs(x_vals - target_x)).argmin()
        shot_y = y[index]
        if abs(shot_y - target_y) < 3:  # ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
            print("\nüéØ HIT! Nice shot!")
        else:
            print("\n‚ùå MISS! Try again.")

    except Exception as e:
        print(f"\nError evaluating formula: {e}")

# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
shooter, target = generate_points()
print(f"Shooter at: {shooter}")
print(f"Target at: {target}")
print("\nEnter your shot as a function of x (e.g., -0.05*(x - 10)**2 + 50 or 20*np.sin(x/10)+50)")
formula_str = input("y = ")

plot_shot(shooter, target, formula_str)
